
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Security evaluation checklist &#8212; Data Safe Haven v3.3.0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/overrides.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/toggle.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tutorials and overview" href="../../tutorial/README.html" />
    <link rel="prev" title="NHS DSPT Security Assessment" href="DSPT.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logo_turing.jpg" class="logo" alt="logo">
</a>      


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../explanations/README.html">
  Learn more about the Safe Haven
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../how_to_guides/README.html">
  How to guides
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../README.html">
  Reference guides
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorial/README.html">
  Tutorials and overview
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/alan-turing-institute/data-safe-haven" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DSPT.html">
   NHS DSPT Security Assessment
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Security evaluation checklist
  </a>
 </li>
</ul>

  </div>
</nav>
    
  
  <div class="rst-versions" data-toggle="rst-downloads" role="note" aria-label="downloads">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-file-pdf fa-fw left"></span>
      <span class="left">Download <strong>latest</strong> PDFs</span>
      <span class="fa fa-caret-down right"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        
          <dd><a href="/data-safe-haven/develop/pdf/data_safe_haven_user_guide_guacamole.pdf">User guide (Apache Guacamole)</a></dd>
        
          <dd><a href="/data-safe-haven/develop/pdf/data_safe_haven_user_guide_msrds.pdf">User guide (Microsoft RDS)</a></dd>
        
          <dd><a href="/data-safe-haven/develop/pdf/data_classification_flow_full.pdf">Classification flowchart</a></dd>
        
          <dd><a href="/data-safe-haven/develop/pdf/data_classification_flow_simple.pdf">Simplified classification  flowchart</a></dd>
        
      </dl>
    </div>
  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book fa-fw left"></span>
      <span class="left">Currently reading: <strong>v3.3.0</strong></span>
      <span class="fa fa-caret-down right"></span>
    </span>
    <div class="rst-other-versions">
      
      
      <dl>
        <dt>Versions</dt>
        
          
          <dd><a href="/data-safe-haven/develop/index.html">develop</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v0.1.0-beta/index.html">v0.1.0-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v0.2.0-beta/index.html">v0.2.0-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v0.3.0-beta/index.html">v0.3.0-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v1.0.0-beta/index.html">v1.0.0-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v1.0.1-beta/index.html">v1.0.1-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v1.1.0-beta/index.html">v1.1.0-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v2.0.0-beta/index.html">v2.0.0-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v3.0.0-beta/index.html">v3.0.0-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v3.0.1-beta/index.html">v3.0.1-beta</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v3.1.0/index.html">v3.1.0</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v3.2.0/index.html">v3.2.0</a></dd>
          
        
           <strong> 
          <dd><a href="/data-safe-haven/v3.3.0/index.html">v3.3.0</a></dd>
           </strong> 
        
          
          <dd><a href="/data-safe-haven/v3.3.1/index.html">v3.3.1</a></dd>
          
        
          
          <dd><a href="/data-safe-haven/v3.4.0/index.html">v3.4.0</a></dd>
          
        
      </dl>
      
      
    </div>
  </div>
</div>




          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-use-this-checklist">
   How to use this checklist
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#contents">
   Contents
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prerequisites">
   Prerequisites
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multifactor-authentication-and-password-strength">
   1. Multifactor Authentication and Password strength
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#we-claim">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#which-means">
     Which means:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verify-by">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#isolated-network">
   2. Isolated Network
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Which means:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#user-devices">
   3. User devices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#this-means">
     This means
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#physical-security">
   4. Physical security
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Which means:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#remote-connections">
   5. Remote connections
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     This means
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copy-and-paste">
   6. Copy-and-paste
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     Which means:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-ingress">
   7. Data ingress
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     This means
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-egress">
   8. Data egress
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id19">
     This means:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-ingress">
   9. Software Ingress
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id21">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     Which means:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id23">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#package-mirrors">
   10. Package mirrors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id24">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id25">
     This means:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id26">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#azure-firewalls">
   11. Azure Firewalls
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     We claim:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     Which means:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id29">
     Verify by:
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/alan-turing-institute/data-safe-haven/edit/develop/docs/reference/checklists/security-checklist.md">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="security-evaluation-checklist">
<h1>Security evaluation checklist<a class="headerlink" href="#security-evaluation-checklist" title="Permalink to this headline">¶</a></h1>
<p>In this check list we aim to do the following things:</p>
<ul class="simple">
<li><p>Establish our current claims about the Data Safe Haven</p></li>
<li><p>Establish what these security claims mean in terms of implementation</p></li>
<li><p>How we can verify that we actually do what we say</p></li>
</ul>
<p>This diagram shows the security standards we’re trying to meet for Data Safe Haven Secure Research Environments (SREs). The security checklist currently focuses on checks that can verify these security requirements for tier 2+ SREs (with some steps noted as specific to a tier):</p>
<p><img alt="recommended_controls" src="../../_images/recommended_controls.png" /></p>
<section id="how-to-use-this-checklist">
<h2>How to use this checklist<a class="headerlink" href="#how-to-use-this-checklist" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Ensure you have an SHM and attached SRE(s) that you wish to test.</p>
<ul>
<li><p>Note: Some parts of the checklist are only relevant when there are multiple SREs attached to the same SHM</p></li>
</ul>
</li>
<li><p>Work your way through the actions described in each section, taking care to notice each time you see a :camera: or a :white_check_mark: and the word <strong>Verify</strong>:</p>
<ul>
<li><p>:camera: Where you see the camera icon, there should be accompanying screenshot(s) of evidence for this item in the checklist (you may wish to save your own equivalent screenshots as evidence)</p></li>
<li><p>:white_check_mark: This indicates a checklist item for which a screenshot is either not appropriate or  difficult</p></li>
</ul>
</li>
</ul>
</section>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#prerequisites">Prerequisites</a></p></li>
<li><p><a class="reference external" href="#1-multifactor-authentication-and-password-strength">Multifactor Authentication and Password strength</a></p></li>
<li><p><a class="reference external" href="#2-isolated-network">Isolated Network</a></p></li>
<li><p><a class="reference external" href="#3-user-devices">User devices</a></p></li>
<li><p><a class="reference external" href="#4-physical-security">Physical security</a></p></li>
<li><p><a class="reference external" href="#5-remote-connections">Remote connections</a></p></li>
<li><p><a class="reference external" href="#6-copy-and-paste">Copy-and-paste</a></p></li>
<li><p><a class="reference external" href="#7-data-ingress">Data Ingress</a></p></li>
<li><p><a class="reference external" href="#8-data-egress">Data Egress</a></p></li>
<li><p><a class="reference external" href="#9-software-ingress">Software ingress</a></p></li>
<li><p><a class="reference external" href="#10-package-mirrors">Package mirrors</a></p></li>
<li><p><a class="reference external" href="#11-azure-firewalls">Azure Firewalls</a></p></li>
</ul>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Deployed SHM</strong> that you are testing</p></li>
<li><p><strong>Deployed SRE A</strong> that is attached to the SHM</p></li>
<li><p><strong>Deployed SRE B</strong> that is attached to the same SHM</p></li>
<li><p><strong>VPN access</strong> to the SHM that you are testing</p>
<ul>
<li><p>If you haven’t already, you’ll need download a VPN certificate and configure <a class="reference external" href="../../tutorial/deployment_tutorials/how-to-deploy-shm.md#download-a-client-vpn-certificate-for-the-safe-haven-management-network">VPN access</a> for the SHM</p></li>
<li><p>Make sure you can use Remote Desktop to log in to the <a class="reference external" href="../../tutorial/deployment_tutorials/how-to-deploy-shm.md#configure-the-first-domain-controller-via-remote-desktop">domain controller (DC1)</a> and the <a class="reference external" href="../../tutorial/deployment_tutorials/how-to-deploy-shm.md#log-in-to-the-nps-vm-using-microsoft-remote-desktop">network policy server (NPS)</a>.</p></li>
</ul>
</li>
</ul>
<p>The following users will be needed for this checklist</p>
<ul class="simple">
<li><p><strong>SRE standard user</strong> who is a member of the <strong>SRE A</strong> research users group</p>
<ul>
<li><p>Create a new user <strong>without</strong> MFA</p>
<ul>
<li><p>Following the <a class="reference external" href="../../tutorial/deployment_tutorials/how-to-deploy-sre.md#optional-set-up-a-non-privileged-user-account">SRE deployment guide</a> for setting up a non privileged user account, create an account, then check the following before (and after (adding them to the <code class="docutils literal notranslate"><span class="pre">SG</span> <span class="pre">&lt;SRE</span> <span class="pre">ID&gt;</span> <span class="pre">Research</span> <span class="pre">Users</span></code> group.</p></li>
<li><p>Visit https://aka.ms/sspr in an incognito browser</p></li>
<li><p>Attempt to login and reset password, but <strong>do not complete MFA</strong> (see <a class="reference external" href="../../how_to_guides/user_guides/user-guide.md#closed_lock_with_key-set-a-password">these steps</a>)</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>System administrator</strong> who has <code class="docutils literal notranslate"><span class="pre">Contributor</span></code> permissions (or higher) on the underlying Azure subscription</p></li>
<li><p><strong>Data provider</strong> who has no accounts on the Safe Haven system</p></li>
</ul>
</section>
<section id="multifactor-authentication-and-password-strength">
<h2>1. Multifactor Authentication and Password strength<a class="headerlink" href="#multifactor-authentication-and-password-strength" title="Permalink to this headline">¶</a></h2>
<section id="we-claim">
<h3>We claim:<a class="headerlink" href="#we-claim" title="Permalink to this headline">¶</a></h3>
<p>Users are required to authenticate with Multi Factor Authentication (MFin order to access the secure analysis environment.</p>
<p>Passwords are strong</p>
</section>
<section id="which-means">
<h3>Which means:<a class="headerlink" href="#which-means" title="Permalink to this headline">¶</a></h3>
<p>Users must set up MFA before accessing the secure analysis environment. Users cannot access the environment without MFA. Users are strongly advised to create passwords of a certain strength.</p>
</section>
<section id="verify-by">
<h3>Verify by:<a class="headerlink" href="#verify-by" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Check that the <strong>SRE standard user</strong> cannot access the apps</p>
<ul>
<li><p>Attempt to login to the remote desktop web client (<code class="docutils literal notranslate"><span class="pre">https://&lt;SRE</span> <span class="pre">ID&gt;.&lt;safe</span> <span class="pre">haven</span> <span class="pre">domain&gt;</span> <span class="pre">(eg.</span> <span class="pre">https://sandbox.turingsafehaven.ac.uk/</span></code>)</p></li>
<li><details>
  <summary>:camera: <b>Verify before adding to group:</b> Guacamole: User is prompted to setup MFA</summary>
<p><img alt="login_no_mfa_guacamole" src="../../_images/login_no_mfa_guacamole.png" /></p>
</details>
</li>
<li><details>
  <summary>:camera: <b>Verify before adding to group:</b> Microsoft Remote Desktop: Login works but apps cannot be viewed</summary>
<p><img alt="login_no_mfa_msrds" src="../../_images/login_no_mfa_msrds.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>Check that adding the <strong>SRE standard user</strong> to the relevant <code class="docutils literal notranslate"><span class="pre">Research</span> <span class="pre">Users</span></code> group under <code class="docutils literal notranslate"><span class="pre">Safe</span> <span class="pre">Haven</span> <span class="pre">Security</span> <span class="pre">Groups</span></code> on the domain controller does not give them access</p>
<ul>
<li><details>
  <summary>:camera: <b>Verify after adding to group:</b> Guacamole: User is prompted to setup MFA</summary>
<p><img alt="login_no_mfa_guacamole" src="../../_images/login_no_mfa_guacamole.png" /></p>
</details>
</li>
<li><details>
  <summary>:camera: <b>Verify after adding to group:</b> Microsoft Remote Desktop: Login works and apps can be viewed</summary>
<p><img alt="msrds_dashboard_with_apps" src="../../_images/msrds_dashboard_with_apps.png" /></p>
</details>
</li>
<li><details>
<summary>:camera: <b>Verify after adding to group:</b> Microsoft Remote Desktop: attempt to login to DSVM Main (Desktop) fails</summary>
<p><img alt="msrds_failed_to_connect" src="../../_images/msrds_failed_to_connect.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>Check that the <strong>SRE standard user</strong> is able to successfully set up MFA</p>
<ul>
<li><p>Visit https://aka.ms/mfasetup in an incognito browser</p></li>
<li><p>Login as the user you set up</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> user guided to set up MFA</p></li>
<li><p>Set up MFA as per <a class="reference external" href="../../how_to_guides/user_guides/user-guide.md#door-set-up-multi-factor-authentication">the user guide instructions</a></p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> successfully set up MFA</summary>
<p><img alt="aad_additional_security_verification" src="../../_images/aad_additional_security_verification.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>Check that the <strong>SRE standard user</strong> can authenticate with MFA</p>
<ul>
<li><p>Login into the remote desktop web client (<code class="docutils literal notranslate"><span class="pre">https://&lt;SRE</span> <span class="pre">ID&gt;.&lt;safe</span> <span class="pre">haven</span> <span class="pre">domain&gt;</span> <span class="pre">(eg.</span> <span class="pre">https://sandbox.turingsafehaven.ac.uk/</span></code>)</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> Guacamole: respond to the MFA prompt</summary>
<p><img alt="aad_mfa_approve_signin_request" src="../../_images/aad_mfa_approve_signin_request.png" /></p>
</details>
</li>
<li><details>
  <summary>:camera: <b>Verify:</b> Microsoft Remote Desktop: attempt to log in to DSVM Main (Desktop) and respond to the MFA prompt</summary>
<p><img alt="aad_mfa_approve_signin_request" src="../../_images/aad_mfa_approve_signin_request.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>Check that the <strong>SRE standard user</strong> can access the DSVM desktop</p>
<ul>
<li><p>Login into the remote desktop web client (<code class="docutils literal notranslate"><span class="pre">https://&lt;SRE</span> <span class="pre">ID&gt;.&lt;safe</span> <span class="pre">haven</span> <span class="pre">domain&gt;</span> <span class="pre">(eg.</span> <span class="pre">https://sandbox.turingsafehaven.ac.uk/</span></code>)</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> Guacamole: connect to <i>Desktop: Ubuntu0</i> </summary>
<p><img alt="dsvm_desktop" src="../../_images/dsvm_desktop.png" /></p>
</details>
</li>
<li><details>
  <summary>:camera: <b>Verify:</b> Microsoft Remote Desktop: connect to <i>DSVM Main (Desktop)</i></summary>
<p><img alt="dsvm_desktop" src="../../_images/dsvm_desktop.png" /></p>
</details>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="isolated-network">
<h2>2. Isolated Network<a class="headerlink" href="#isolated-network" title="Permalink to this headline">¶</a></h2>
<section id="id1">
<h3>We claim:<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The DSH Virtual Network is isolated from external connections (both tier 2 and 3)</p>
</section>
<section id="id2">
<h3>Which means:<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Users cannot access any part of the network without already being in the network. Being part of the network involves connecting using an SHM specific Management VPN.</p>
<p>Whilst in the network, one cannot use the internet to connect outside the network.</p>
<p>SREs in the same SHM are still isolated from one another.</p>
</section>
<section id="id3">
<h3>Verify by:<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Connect to the SHM DC, NPS, Data server if and only if connected to the SHM VPN:</p>
<ul class="simple">
<li><p>Connect to the SHM VPN</p></li>
<li><p>Attempt to connect to the SHM DC and SHM NPS</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Connection works</p></li>
<li><p>Disconnect from the SHM VPN</p></li>
<li><p>Attempt to connect to the SHM DC and SHM NPS</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Connection fails</p></li>
</ul>
</li>
<li><p>Fail to connect to the internet from within a DSVM on the SRE network.</p>
<ul>
<li><p>Login as a user to a DSVM from within the SRE by using the web client.</p></li>
<li><p>Choose your favourite three websites and attempt to access the internet using a browser</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> Connection fails</summary>
<p><img alt="dsvm_no_internet" src="../../_images/dsvm_no_internet.png" /></p>
</details>
</li>
<li><details>
  <summary>:camera: <b>Verify:</b> that you cannot access a website using curl</summary>
<p><img alt="dsvm_no_curl" src="../../_images/dsvm_no_curl.png" /></p>
</details>
</li>
<li><details>
  <summary>:camera: <b>Verify:</b> that you cannot get the IP address for a website using nslookup</summary>
<p><img alt="dsvm_no_nslookup" src="../../_images/dsvm_no_nslookup.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>Check that users cannot connect from one SRE to another one in the same SHM, even if they have access to both SREs</p>
<ul>
<li><p>Ensure that the <strong>SRE standard user</strong> is a member of the research users group for both <strong>SRE A</strong> and <strong>SRE B</strong></p></li>
<li><p>Connect to SRE A as the <strong>SRE standard user</strong> by using the web client.</p></li>
<li><p>Log in to the DSVM remote desktop:</p></li>
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">Terminal</span></code> app from the dock at the bottom of the screen and enter <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-v</span> <span class="pre">-o</span> <span class="pre">ConnectTimeout=10</span> <span class="pre">&lt;IP</span> <span class="pre">address&gt;</span></code> where the IP address is one for a DSVM in SRE B (you can find this in the Azure portal)</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> Connection fails </summary>
<p><img alt="ssh_connection_fail" src="../../_images/ssh_connection_fail.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>Check that users cannot copy files from one SRE to another one in the same SHM</p>
<ul class="simple">
<li><p>Connect to a DSVM in SRE A as the <strong>SRE standard user</strong> by using the web client.</p></li>
<li><p>In a separate browser window, do the same for SRE B.</p></li>
<li><p>Attempt to copy and paste a file from one SRE desktop to another</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Copy and paste is not possible</p></li>
</ul>
</li>
<li><p>Check that the network rules are set appropriately to block outgoing traffic</p>
<ul>
<li><p>Visit the portal and find <code class="docutils literal notranslate"><span class="pre">NSG_SHM_&lt;SHM</span> <span class="pre">ID&gt;_SRE_&lt;SRE</span> <span class="pre">ID&gt;_COMPUTE</span></code>, then click on the <code class="docutils literal notranslate"><span class="pre">Outbound</span> <span class="pre">security</span> <span class="pre">rules</span></code> under <code class="docutils literal notranslate"><span class="pre">Settings</span></code></p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> There exists an NSG rule with Destination "Internet" and Action "Deny" and that no higher priority rule allows connection to the internet.</summary>
<p><img alt="nsg_outbound_access" src="../../_images/nsg_outbound_access.png" /></p>
</details>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="user-devices">
<h2>3. User devices<a class="headerlink" href="#user-devices" title="Permalink to this headline">¶</a></h2>
<section id="id4">
<h3>We claim:<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>At tier 3, only managed devices can connect to the DSH environment.</p>
<p>At tier 2, all kinds of devices can connect to the DSH environment (with VPN connection and correct credentials).</p>
</section>
<section id="this-means">
<h3>This means<a class="headerlink" href="#this-means" title="Permalink to this headline">¶</a></h3>
<p>A managed device is a device provided by a partner institution in which the user does not have admin or root access.</p>
<p>Network rules for the higher tier Environments can permit access only from Restricted network IP ranges that only permit managed devices to connect.</p>
</section>
<section id="id5">
<h3>Verify by:<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>For tier 2:</p>
<ul class="simple">
<li><p>One can connect regardless of device as long as one has an allow-listed IP address and credentials</p>
<ul>
<li><p>Using a personal device, connect to the environment using an allow-listed IP address and credentials</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Connection succeeds</p></li>
<li><p>Using a managed device, connect to the environment using an allow-listed IP address and credentials.</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Connection succeeds</p></li>
</ul>
</li>
</ul>
<p>For tier 3:</p>
<ul class="simple">
<li><p>A device is managed by checking user permissions and where the device has come from. We should check that it is managed by the partner institution’s IT team.</p>
<ul>
<li><p>Check that the device is managed by the partner institution IT team</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> The user lacks root access</p></li>
</ul>
</li>
<li><p>A device is able to connect to the environment if and only if it is managed (with correct VPN and credentials)</p>
<ul>
<li><p>Using a personal device, attempt to connect to the environment using the correct VPN and credentials</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Connection fails</p></li>
<li><p>Using a managed device, attempt to connect to the environment using the correct VPN and credentials</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Connection succeeds</p></li>
</ul>
</li>
</ul>
<p>For tiers 2 and above:</p>
<ul>
<li><p>There are are network rules permitting access only from allow-listed IP addresses</p>
<ul>
<li><p>Navigate to the NSG for this SRE in the portal:</p>
<ul class="simple">
<li><p><em>Microsoft Remote Desktop:</em> <code class="docutils literal notranslate"><span class="pre">NSG_SHM_&lt;SHM</span> <span class="pre">ID&gt;_SRE_&lt;SRE</span> <span class="pre">ID&gt;_RDS_SERVER</span></code></p></li>
<li><p><em>Guacamole:</em> <code class="docutils literal notranslate"><span class="pre">NSG_SHM_&lt;SHM</span> <span class="pre">ID&gt;_SRE_&lt;SRE</span> <span class="pre">ID&gt;_GUACAMOLE</span></code></p></li>
</ul>
</li>
<li><details>
  <summary>:camera: <b>Verify:</b> The NSG has network rules allowing <b>inbound</b> access from allow-listed IP addresses only</summary>
<p><img alt="nsg_inbound_access" src="../../_images/nsg_inbound_access.png" /></p>
</details>
</li>
<li><p>:white_check_mark: <strong>Verify:</strong> All other NSGs (apart from <code class="docutils literal notranslate"><span class="pre">NSG_SHM_&lt;SHM</span> <span class="pre">ID&gt;_SRE_&lt;SRE</span> <span class="pre">ID&gt;_DEPLOYMENT</span></code>) have an inbound <code class="docutils literal notranslate"><span class="pre">Deny</span> <span class="pre">All</span></code> rule and no higher priority rule allowing inbound connections from outside the Virtual Network (apart from the Admin VPN in some cases).</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="physical-security">
<h2>4. Physical security<a class="headerlink" href="#physical-security" title="Permalink to this headline">¶</a></h2>
<section id="id6">
<h3>We claim:<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>At tier 3 access is limited to certain secure physical spaces</p>
</section>
<section id="id7">
<h3>Which means:<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Medium security research spaces control the possibility of unauthorised viewing. Card access or other means of restricting entry to only known researchers (such as the signing in of guests on a known list) is required. Screen adaptations or desk partitions can be adopted in open-plan spaces if there is a high risk of “visual eavesdropping”.</p>
<p>Firewall rules for the Environments can permit access only from Restricted network IP ranges corresponding to these research spaces.</p>
</section>
<section id="id8">
<h3>Verify by:<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>For tier 3:</p>
<ul class="simple">
<li><p>Connection from outside the secure physical space is not possible.</p>
<ul>
<li><p>Attempt to connect to the tier 3 SRE web client from home using a managed device and the correct VPN connection and credentials</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> connection fails</p></li>
</ul>
</li>
<li><p>Connection from within the secure physical space is possible.</p>
<ul>
<li><p>Attempt to connect from research office using a managed device and the correct VPN connection and credentials</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> connection succeeds</p></li>
</ul>
</li>
<li><p>:white_check_mark: <strong>Verify:</strong> Check the network IP ranges corresponding to the research spaces and compare against the IPs accepted by the firewall.</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Confirm in person that physical measures such as screen adaptions or desk partitions are present.</p></li>
</ul>
</section>
</section>
<section id="remote-connections">
<h2>5. Remote connections<a class="headerlink" href="#remote-connections" title="Permalink to this headline">¶</a></h2>
<section id="id9">
<h3>We claim:<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Connections can only be made via remote desktop (Tier 2+)</p>
</section>
<section id="id10">
<h3>This means<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>User can connect via remote desktop but cannot connect through other means such as SSH</p>
</section>
<section id="id11">
<h3>Verify by:<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Unable to connect as the <strong>SRE standard user</strong> to the remote desktop server via SSH</p>
<ul>
<li><p>Attempt <code class="docutils literal notranslate"><span class="pre">ssh</span></code> login with <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">&lt;user.name&gt;&#64;&lt;SRE</span> <span class="pre">ID&gt;.&lt;safe</span> <span class="pre">haven</span> <span class="pre">domain&gt;</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-v</span> <span class="pre">-o</span> <span class="pre">ConnectTimeout=10</span> <span class="pre">ada.lovelace&#64;sandbox.turingsafehaven.ac.uk</span></code>)</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> ssh login by fully-qualified domain name fails </summary>
<p><img alt="dsvm_no_ssh_by_fqdn" src="../../_images/dsvm_no_ssh_by_fqdn.png" /></p>
</details>
</li>
<li><p>Find the public IP address for the remote desktop server VM (<em>Microsoft Remote Desktop:</em> <code class="docutils literal notranslate"><span class="pre">RDG-SRE-&lt;SRE</span> <span class="pre">ID&gt;</span></code>; <em>Guacamole</em>: <code class="docutils literal notranslate"><span class="pre">GUACAMOLE-SRE-&lt;SRE</span> <span class="pre">ID&gt;</span></code>) by searching for this VM in the portal, then looking at <code class="docutils literal notranslate"><span class="pre">Connect</span></code> under <code class="docutils literal notranslate"><span class="pre">Settings</span></code>.</p></li>
<li><p>Attempt <code class="docutils literal notranslate"><span class="pre">ssh</span></code> login with <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">&lt;user.name&gt;&#64;&lt;public</span> <span class="pre">IP&gt;</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">ada.lovelace&#64;8.8.8.8</span></code>)</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> ssh login by public IP address fails </summary>
<p><img alt="dsvm_no_ssh_by_ip" src="../../_images/dsvm_no_ssh_by_ip.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>:white_check_mark: <strong>Verify:</strong> The remote desktop server (<code class="docutils literal notranslate"><span class="pre">RDG-SRE-&lt;SRE</span> <span class="pre">ID&gt;</span></code>) is the only SRE resource with a public IP address</p></li>
</ul>
</section>
</section>
<section id="copy-and-paste">
<h2>6. Copy-and-paste<a class="headerlink" href="#copy-and-paste" title="Permalink to this headline">¶</a></h2>
<section id="id12">
<h3>We claim:<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>Copy and paste is disabled on the remote desktop</p>
</section>
<section id="id13">
<h3>Which means:<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>One cannot copy something from outside the network and paste it into the network. One cannot copy something from within the network and paste it outside the network.</p>
</section>
<section id="id14">
<h3>Verify by:<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Users are unable to copy some text from outside the network, into a DSVM and vice versa</p>
<ul>
<li><p>Copy some text from your deployment device</p></li>
<li><p>Login to a DSVM as the <strong>SRE standard user</strong> via the remote desktop web client</p></li>
<li><p>Open up a notepad or terminal on the DSVM and attempt to paste the text to it.</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> paste fails</p></li>
<li><p>Write some next in the note pad or terminal of the DSVM and copy it</p></li>
<li><p>Attempt to copy the text externally to deployment device (e.g. into URL of browser)</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> paste fails</p></li>
</ul>
</li>
<li><p>Users can copy between VMs inside the network</p>
<ul>
<li><p>Login to a DSVM as the <strong>SRE standard user</strong> via the remote desktop web client</p></li>
<li><p>Open up a notepad or terminal on the DSVM and attempt to paste the text to it.</p></li>
<li><p>In another tab or browser connect to a different DSVM (or to the same VM via the SSH connection) using the remote desktop web client</p></li>
<li><p>Attempt to paste the text to it.</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> paste succeeds</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="data-ingress">
<h2>7. Data ingress<a class="headerlink" href="#data-ingress" title="Permalink to this headline">¶</a></h2>
<section id="id15">
<h3>We claim:<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>All data transfer to the Turing should be via our secure data transfer process, which gives the Dataset Provider time-limited, write-only access to a dedicated data ingress volume from a specific location.</p>
<p>Data is stored in a holding zone until approved to be added for user access.</p>
</section>
<section id="id16">
<h3>This means<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>Prior to access to the ingress volume being provided, the Dataset Provider Representative must provide the IP address(es) from which data will be uploaded and an email address to which a secure upload token can be sent. Once these details have been received, the Turing will open the data ingress volume for upload of data.</p>
<p>To minimise the risk of unauthorised access to the dataset while the ingress volume is open for uploads, the following security measures are in place:</p>
<ul class="simple">
<li><p>Access to the ingress volume is restricted to a limited range of IP addresses associated with the Dataset Provider and the Turing.</p></li>
<li><p>The Dataset Provider receives a write-only upload token. This allows them to upload, verify and modify the uploaded data, but does not viewing or download of the data. This provides protection against an unauthorised party accessing the data, even they gain access to the upload token.</p></li>
<li><p>The upload token expires after a time-limited upload window.</p></li>
<li><p>The upload token is transferred to the Dataset Provider via a secure email system.</p></li>
</ul>
</section>
<section id="id17">
<h3>Verify by:<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>To test all the above, you will need to act both as the administrator and data provider:</p>
<ul class="simple">
<li><p>As the <strong>system administrator</strong> generate a secure upload token and check it can be sent to the email address provided by the <strong>data provider</strong> via a secure email system</p>
<ul>
<li><p>:white_check_mark: <strong>Verify:</strong> that a secure upload token can be created with write-only permissions, by following the instructions in the <a class="reference external" href="../../how_to_guides/administrator/how-to-be-a-sysadmin.md#data-ingress">administrator document</a>, using the IP address of your own device in place of that of the data provider</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> that you are able to send a secure email containing this token (e.g. send it to your own email for testing purposes)</p></li>
</ul>
</li>
<li><p>Ensure that data ingress works for connections from within the accepted IP address and does not work for connections outside the IP address, even if the correct upload token is present.</p>
<ul>
<li><p>As the <strong>data provider</strong>, ensure you’re working from a device that has an allow-listed IP address</p></li>
<li><p>Using the secure upload token with write-only permissions and limited time period that you set up in the previous step, follow the <a class="reference internal" href="../../how_to_guides/data_provider/how-to-ingress-data-as-provider.html"><span class="doc std std-doc">ingress instructions for the data provider</span></a></p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> that writing succeeds by uploading a file</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> that attempting to open or download any of the files results in the following error: <code class="docutils literal notranslate"><span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">start</span> <span class="pre">transfer:</span> <span class="pre">Insufficient</span> <span class="pre">credentials.</span></code> under the <code class="docutils literal notranslate"><span class="pre">Activities</span></code> pane at the bottom of the MS Azure Storage Explorer window</p></li>
<li><p>Switch to a device that lacks an allow-listed IP address (or change your IP with a VPN)</p></li>
<li><p>Attempt to write to the ingress volume via the test device</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> that the access token fails.</p></li>
</ul>
</li>
<li><p>Check the token duration and ensure that the upload fails if the duration has expired.</p>
<ul>
<li><p>Create a write-only token with short duration</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> you can connect and write with the token during the duration</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> you cannot connect and write with the token after the duration has expired</p></li>
</ul>
</li>
<li><p>:white_check_mark: <strong>Verify:</strong> Check that the overall ingress works by uploading different kinds of files, e.g. data, images, scripts (if appropriate).</p></li>
</ul>
</section>
</section>
<section id="data-egress">
<h2>8. Data egress<a class="headerlink" href="#data-egress" title="Permalink to this headline">¶</a></h2>
<section id="id18">
<h3>We claim:<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>SREs contain an <code class="docutils literal notranslate"><span class="pre">/output</span></code> volume, in which SRE users can store data designated for egress.</p>
</section>
<section id="id19">
<h3>This means:<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<p>A <strong>system administrator</strong> can view and download data in the <code class="docutils literal notranslate"><span class="pre">/output</span></code> volume via Azure Storage Explorer.</p>
</section>
<section id="id20">
<h3>Verify by:<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Confirm that a non-privileged user is able to read the different storage volumes and write to Output</p>
<ul>
<li><p>Login to a DSVM as the <strong>SRE standard user</strong> via the remote desktop web client</p></li>
<li><p>Open up a file explorer and search for the various storage volumes</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> that the <code class="docutils literal notranslate"><span class="pre">/output</span></code> volume exists and can be read and written to</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> that the permissions of other storage volumes match that described in the <a class="reference external" href="../../how_to_guides/user_guides/user-guide.md#open_file_folder-shared-directories-within-the-sre">user guide</a></p></li>
</ul>
</li>
<li><p>Confirm that the different volumes exist in blob storage and that logging on requires domain admin permissions</p>
<ul>
<li><p>As the <strong>system administrator</strong>, follow the instructions in the <a class="reference external" href="../../how_to_guides/administrator/how-to-be-a-sysadmin.md#data-egress">administrator document</a> on how to access files set for egress with Azure Storage Explorer</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> You can see the files written to the Output storage volume (including any you created as a non-privileged user in step 1)</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> that a written file can be taken out of the environment via download</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="software-ingress">
<h2>9. Software Ingress<a class="headerlink" href="#software-ingress" title="Permalink to this headline">¶</a></h2>
<section id="id21">
<h3>We claim:<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>The base data science virtual machine provided in the secure analysis Environments comes with a wide range of common data science software pre-installed, as well as package mirrors. For other kinds of software this must be added separately via ingress.</p>
<p>Software is stored in a holding zone until approved to be added for user access.</p>
</section>
<section id="id22">
<h3>Which means:<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p>For tier 0/1 environments, outbound internet access means users can directly download their software from the internet. For tier 2+ environments we use the secure data transfer process.</p>
<ul class="simple">
<li><p>Installation during deployment</p>
<ul>
<li><p>If known in advance, software can be installed during DSVM deployment whilst there is still internet access, but before project data is added. Once the software is installed, the DSVM undergoes ingress into the environment with a one way lock.</p></li>
</ul>
</li>
<li><p>Installation after deployment</p>
<ul>
<li><p>Once a DSVM has been deployed into the analysis environment it cannot be moved out. There is no outbound internet access.</p></li>
<li><p>Software is added via ingress in a similar manner to data. Researchers are provided temporary write-only access to the software ingress volume (external mode). The access is then revoked and the software is then reviewed. If it passes review, the software ingress volume is changed to provide researchers with read-only access to the environment (internal mode).</p></li>
<li><p>If the software requires administrator rights to install, a System Manager must do this. Otherwise, the researcher can do this themselves.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id23">
<h3>Verify by:<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Check that some software tools were installed as expected during deployment</p>
<ul>
<li><p>Login to a DSVM as the <strong>SRE standard user</strong> via the remote desktop web client</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> Confirm that the following programmes can be opened without issue: DBeaver, RStudio, PyCharm and Visual Studio Code</summary>
<p><img alt="dsvm_installed_software" src="../../_images/dsvm_installed_software.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>Check that it’s possible to grant and revoke software ingress capability by following the instructions in the <a class="reference external" href="../../how_to_guides/administrator/how-to-be-a-sysadmin.md#software-ingress">Safe Haven Administrator Documentation</a>:</p>
<ul class="simple">
<li><p>:white_check_mark: <strong>Verify:</strong> You can generate a temporary write-only upload token</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> You can upload software as a non-admin with this token, but write access is revoked after the temporary token has expired</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Software uploaded to the by a non-admin can be read by administrators</p></li>
<li><p>:white_check_mark: <strong>Verify:</strong> Check that the <strong>SRE standard user</strong> cannot install software that requires administrator rights (e.g. anything that is installed with <code class="docutils literal notranslate"><span class="pre">apt</span></code>)</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="package-mirrors">
<h2>10. Package mirrors<a class="headerlink" href="#package-mirrors" title="Permalink to this headline">¶</a></h2>
<section id="id24">
<h3>We claim:<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<p>Tier 2: User can access all packages from PyPI/CRAN</p>
<p>Tier 3: User can only access approved packages from PyPI/CRAN</p>
</section>
<section id="id25">
<h3>This means:<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<p>Tier 2: The user can access any package from our mirrors. They can freely use these packages without restriction.</p>
<p>Tier 3: The user can only access a specific pre-agreed set of packages. They will be unable to download any package not on the allowed list.</p>
</section>
<section id="id26">
<h3>Verify by:<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<p>Tier 2:</p>
<ul>
<li><p>Download packages from the full mirror.</p>
<ul>
<li><p>Login as the <strong>SRE standard user</strong> into a DSVM via remote desktop web client</p></li>
<li><p>Open up a terminal</p></li>
<li><p>Attempt to install any package that is not included out-of-the-box (for example, try <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">botocore</span></code>)</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> You can install the package </summary>
<p><img alt="dsvm_pypi_tier2" src="../../_images/dsvm_pypi_tier2.png" /></p>
</details>
</li>
</ul>
</li>
</ul>
<p>Tier 3:</p>
<ul>
<li><p>Download packages on the allowed list (see the lists in <code class="docutils literal notranslate"><span class="pre">environment_configs/package_lists</span></code>)</p>
<ul>
<li><p>Login as the <strong>SRE standard user</strong> into a DSVM via remote desktop web client</p></li>
<li><p>Attempt to install a package on the allowed list that is not included out-of-the-box (for example, try <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">aero-calc</span></code>)</p></li>
<li><p>Then attempt to download a package that is not included in the allowed list (for example, try <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">botocore</span></code>)</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> the first download succeeds and the second fails</summary>
<p><img alt="dsvm_pypi_tier3" src="../../_images/dsvm_pypi_tier3.png" /></p>
</details>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="azure-firewalls">
<h2>11. Azure Firewalls<a class="headerlink" href="#azure-firewalls" title="Permalink to this headline">¶</a></h2>
<section id="id27">
<h3>We claim:<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<p>An Azure Firewall ensures that the administrator VMs have the minimal level of internet access required to function.</p>
</section>
<section id="id28">
<h3>Which means:<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<p>Whilst all user access VMs are entirely blocked off from the internet, this is not the case for administrator access VMs such as the SHM-DC, SRE DATA server. An Azure Firewall governs the internet access provided to these VMs, limiting them mostly to downloading Windows updates.</p>
</section>
<section id="id29">
<h3>Verify by:<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Admin has limited access to the internet</p>
<ul>
<li><p>As the <strong>system administrator</strong> use Remote Desktop to connect to the SHM domain controller VM</p></li>
<li><p>Attempt to connect to a non-approved site, such as <code class="docutils literal notranslate"><span class="pre">www.google.com</span></code></p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> connection fails</summary>
<p><img alt="shmdc_website_deny" src="../../_images/shmdc_website_deny.png" /></p>
</details>
</li>
</ul>
</li>
<li><p>Admin can download Windows updates</p>
<ul>
<li><p>As the <strong>system administrator</strong> use Remote Desktop to connect to the SHM domain controller VM</p></li>
<li><p>Click on <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">-&gt;</span> <span class="pre">Settings-&gt;</span> <span class="pre">Update</span> <span class="pre">&amp;</span> <span class="pre">Security</span></code></p></li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">Download</span></code> button</p></li>
<li><details>
  <summary>:camera: <b>Verify:</b> download and update successful</summary>
<p><img alt="shmdc_windows_update" src="../../_images/shmdc_windows_update.png" /></p>
</details>
</li>
</ul>
</li>
</ul>
</section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="DSPT.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">NHS DSPT Security Assessment</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../tutorial/README.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tutorials and overview</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, The Alan Turing Institute.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/en/master/">Sphinx</a> 4.3.0.
    Hosted by <a href="https://pages.github.com/">GitHub Pages</a>.
    <br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>